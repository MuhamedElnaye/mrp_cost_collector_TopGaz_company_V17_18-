<odoo>
    <record id="sale_orders_report" model="ir.actions.report">
        <field name="name">Sale Orders Report1</field>
        <field name="model">sale.order</field>
        <field name="report_type">qweb-pdf</field>
<!--        <field name="binding_model_id" ref="sale.model_sale_order"/>-->
        <field name="binding_type">report</field>
        <field name="report_name">mrp_cost_collector.sale_order_report_template</field>
    </record>
    <template id="sale_order_report_template">
        <t t-call="web.html_container">
            <t t-call="web.basic_layout">
                 <style>
                    html, body {
                    width: 80mm;
                    margin: 0 !important;
                    padding: 0 !important;
                    }
                    @page {
                    size: 80mm auto;
                    margin: 0 !important;
                    }
                    .page {
                    width: 80mm;
                    margin: auto;
                    font-size: 12px;
                    line-height: 1.3;
                    font-family: 'Arial', sans-serif;
                    display: block;
                    min-height: auto; /* لتجنب تقطيع الصفحة */
                    }
                    table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 10px;
                    margin: 0 !important;
                    }
                    th, td {
                    border: 1px solid #000;
                    padding: 2px;
                    text-align: center;
                    font-size: 10px;
                    font-weight: bold;
                    }
                    h2 {
                    font-size: 16px;
                    margin: 2px 0;
                    text-align: center;
                    font-weight: bold;
                    }
                    p {
                    margin: 2px 0;
                    }
                    .or_line{
                    color:white;
                    padding:16px;
                    }
                </style>
                <div class="page">
                    <t t-foreach="docs" t-as="rec">
                        <h2>MG</h2>
                        <h2>شركة ام ايه جى للصناعات الهندسية
                            ( شركة مساهمة مصرية )
                        </h2>
                        <h2>
                            <strong>Order #</strong>
                            <t t-esc="rec.name"/>
                        </h2>
                        <div class="border border-2 p-3">
                            <p>
                                <strong>Customer Name:</strong>
                                <t t-esc="rec.partner_id.display_name"/>
                            </p>
                            <p>
                                <strong>Salesperson:</strong>
                                <t t-esc="rec.user_id.name"/>
                            </p>
                            <p>
                                <strong>Order Date:</strong>
                                <t t-esc="rec.date_order.strftime('%d-%m-%Y %H:%M')"/>
                            </p>
                        </div>
                        <br/>

                        <table class="table table-sm"
                               style="width:100%; border: 1px solid black; border-collapse: collapse;">
                            <thead class="text-white p-3" style="background-color:#a3193c !important;color:white !important;">
                                <tr>
                                    <th style="border: 1px solid black;">DESCRIP</th>
                                    <th style="border: 1px solid black;">QUANT</th>
                                    <th style="border: 1px solid black;">UNIT PRICE</th>
                                    <th style="border: 1px solid black;">TAXES</th>
                                    <th style="border: 1px solid black;">AMOUNT</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="rec.order_line" t-as="line">
                                    <td style="border: 1px solid black;">
                                        <t t-esc="line.product_id.name"/>
                                    </td>
                                    <td style="border: 1px solid black;">
                                        <t t-esc="line.product_uom_qty"/>
                                    </td>
                                    <td style="border: 1px solid black;">
                                        <t t-esc="'{:,.3f}'.format(line.price_unit)"/>
                                        EGP
                                    </td>
                                    <td style="border: 1px solid black;">
                                        <t t-esc="'{:,.3f}'.format(rec.amount_tax)"/>
                                        EGP
                                    </td>
                                    <td style="border: 1px solid black;">
                                        <t t-esc="'{:,.3f}'.format(line.price_subtotal)"/>
                                        EGP
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br/>
                        <table>
                            <tr>
                                <td>
                                    <strong>Untaxed Amount:</strong>
                                </td>
                                <td class="fw-bold">
                                    <t t-esc="'{:,.3f}'.format(rec.amount_untaxed)"/>
                                    EGP
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>VAT 14% :</strong>
                                </td>
                                <td class="fw-bold">
                                    <t t-esc="'{:,.3f}'.format(rec.amount_tax)"/>
                                    EGP
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Subtotal W/O WHTax</strong>
                                </td>
                                <td class="fw-bold">
                                    <t t-esc="'{:,.3f}'.format(rec.amount_total)"/>
                                    EGP
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Withholding Tax -1%</strong>
                                </td>
                                <td class="fw-bold">
                                    <t t-esc="'{:,.3f}'.format(rec.amount_untaxed * -1 / 100)"/>
                                    EGP
                                </td>
                            </tr>
                            <tr class="text-white p-5" style="background-color:#a3193c; color:white;">
                                <td>
                                    <strong>Total</strong>
                                </td>
                                <td class="fw-bold">
                                    <t t-set="discount" t-value="(rec.amount_untaxed) * (-1/100)"/>
                                    <t t-set="total_after_discount" t-value="discount + rec.amount_total"/>
                                    <t t-esc="'{:,.3f}'.format(total_after_discount)"/>
                                    EGP
                                </td>
                            </tr>
                        </table>
                    </t>
                </div>
            </t>
        </t>
    </template>
    <!--    menu items-->
    <record id="view_order_form_custom_fawry" model="ir.ui.view">
        <field name="name">sale.order.form.fawry.button</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <button name="print_fawry_invoice"
                        string="طباعة صغيره"
                        type="object"
                        class="btn btn-primary"
                        icon="fa-print"/>
            </xpath>
        </field>
    </record>
</odoo>

